<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Vida UPMH</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --accent-color: #ff6b6b;
            --light-color: #f8f9fa;
            --dark-color: #2d3436;
            --success-color: #00b894;
            --warning-color: #fdcb6e;
            --danger-color: #e17055;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.1);
            --gradient: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --radius: 16px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 80px;
        }

        .container {
            width: 100%;
            padding: 0 15px;
        }

        /* Header Móvil */
        .mobile-header {
            background: var(--gradient);
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo h1 {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .user-menu {
            display: flex;
            gap: 15px;
        }

        .user-menu i {
            font-size: 1.2rem;
        }

        .date-display {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Navegación inferior */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 100;
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #777;
            font-size: 0.75rem;
            transition: var(--transition);
            padding: 5px;
        }

        .nav-item.active {
            color: var(--primary-color);
            transform: translateY(-5px);
        }

        .nav-icon {
            font-size: 1.3rem;
            margin-bottom: 4px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-item.active .nav-icon {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Sección de Bienvenida */
        .welcome-card {
            background: var(--gradient);
            color: white;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }

        .welcome-card::before {
            content: "";
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: rgba(255,255,255,0.1);
            transform: rotate(30deg);
        }

        .welcome-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            position: relative;
            z-index: 2;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
            position: relative;
            z-index: 2;
        }

        .progress-fill {
            height: 100%;
            background: white;
            width: 70%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 1rem 0;
        }

        .stat-item {
            background: white;
            border-radius: var(--radius);
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: var(--card-shadow);
        }

        .stat-icon {
            font-size: 1.5rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient);
            color: white;
        }

        .stat-info {
            flex: 1;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 0.8rem;
            color: #777;
        }

        /* Acciones Rápidas */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 1.5rem 0;
        }

        .action-btn {
            background: white;
            border-radius: var(--radius);
            padding: 1.2rem 0.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: var(--dark-color);
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            border: none;
            cursor: pointer;
        }

        .action-btn:active {
            transform: scale(0.95);
        }

        .action-icon {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            height: 40px;
        }

        .action-emoji {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            height: 40px;
        }

        /* Cards Deslizables */
        .section-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 1.5rem 0 1rem 0;
        }

        .section-title h3 {
            font-size: 1.3rem;
            color: var(--primary-color);
        }

        .see-all {
            font-size: 0.8rem;
            color: var(--secondary-color);
            text-decoration: none;
        }

        .cards-scroll {
            display: flex;
            overflow-x: auto;
            gap: 15px;
            padding: 10px 0;
            margin: 1rem 0;
            scrollbar-width: none;
        }

        .cards-scroll::-webkit-scrollbar {
            display: none;
        }

        .card {
            background: white;
            border-radius: var(--radius);
            padding: 1.2rem;
            min-width: 280px;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            position: relative;
        }

        .card:active {
            transform: scale(0.98);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            color: white;
            font-size: 1.2rem;
        }

        .card h3 {
            font-size: 1.1rem;
            color: var(--primary-color);
        }

        .task-item, .event-item, .person-item {
            display: flex;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px solid #eee;
        }

        .task-item:last-child, .event-item:last-child, .person-item:last-child {
            border-bottom: none;
        }

        .task-checkbox {
            margin-right: 10px;
            width: 20px;
            height: 20px;
            accent-color: var(--primary-color);
        }

        .task-text {
            flex-grow: 1;
            font-size: 0.9rem;
        }

        .task-priority {
            padding: 0.3rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .priority-high {
            background: rgba(255, 107, 107, 0.2);
            color: var(--danger-color);
        }

        .priority-medium {
            background: rgba(253, 203, 110, 0.2);
            color: #e17055;
        }

        .priority-low {
            background: rgba(0, 184, 148, 0.2);
            color: var(--success-color);
        }

        .event-time {
            background: rgba(37, 117, 252, 0.1);
            color: var(--secondary-color);
            padding: 0.3rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            margin-right: 10px;
            font-weight: 600;
            min-width: 60px;
            text-align: center;
        }

        .person-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .person-info {
            flex-grow: 1;
        }

        .person-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .person-relation {
            font-size: 0.7rem;
            color: #777;
        }

        /* Botones de acción en cards */
        .card-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
        }

        .action-btn-small {
            background: rgba(0,0,0,0.1);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.8rem;
        }

        .action-btn-small:hover {
            background: rgba(0,0,0,0.2);
        }

        .delete-btn {
            color: var(--danger-color);
        }

        .edit-btn {
            color: var(--secondary-color);
        }

        /* Bienestar Social */
        .emotion-form {
            background: white;
            border-radius: var(--radius);
            padding: 1.2rem;
            margin-bottom: 1rem;
            box-shadow: var(--card-shadow);
        }

        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-control {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }

        .emotion-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .emotion-tag {
            padding: 0.6rem 0.8rem;
            background: #f1f2f6;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .emotion-tag.active {
            background: var(--primary-color);
            color: white;
            transform: scale(1.05);
        }

        .emoji {
            font-size: 1rem;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            font-size: 1rem;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-cancel {
            background: #f1f2f6;
            color: var(--dark-color);
        }

        .analysis-result {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .recommendation {
            background: rgba(0, 184, 148, 0.1);
            border-left: 4px solid var(--success-color);
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 0 8px 8px 0;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            width: 100%;
            max-width: 400px;
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            animation: modalAppear 0.3s ease;
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.2rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--dark-color);
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 1.5rem;
        }

        .modal-actions .btn {
            width: auto;
            flex: 1;
        }

        /* Estados vacíos */
        .empty-state {
            text-align: center;
            padding: 2rem 1rem;
            color: #777;
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #ddd;
        }

        /* Notificaciones */
        .notification {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success-color);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            animation: notificationSlide 0.3s ease;
            display: none;
        }

        @keyframes notificationSlide {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- Header Móvil -->
    <header class="mobile-header">
        <div class="header-top">
            <div class="logo">
                <h1>Mi Vida UPMH 🎓</h1>
            </div>
            <div class="user-menu">
                <i class="fas fa-bell"></i>
                <i class="fas fa-cog"></i>
            </div>
        </div>
        <div class="date-display" id="current-date">Cargando fecha...</div>
    </header>

    <!-- Notificación -->
    <div class="notification" id="notification"></div>

    <main class="container">
        <!-- Tarjeta de Bienvenida -->
        <div class="welcome-card">
            <div class="welcome-header">
                <div>
                    <h2>¡Hola de nuevo! 👋</h2>
                    <p id="welcome-message">Cargando...</p>
                </div>
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>

        <!-- Estadísticas -->
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-icon">📚</div>
                <div class="stat-info">
                    <div class="stat-value" id="task-count">0/0</div>
                    <div class="stat-label">Tareas</div>
                </div>
            </div>
            <div class="stat-item">
                <div class="stat-icon">❤️</div>
                <div class="stat-info">
                    <div class="stat-value" id="emotion-count">0</div>
                    <div class="stat-label">Emociones</div>
                </div>
            </div>
        </div>

        <!-- Acciones Rápidas -->
        <div class="quick-actions">
            <button class="action-btn" id="add-task-btn">
                <div class="action-emoji">📝</div>
                <span>Nueva Tarea</span>
            </button>
            <button class="action-btn" id="add-event-btn">
                <div class="action-emoji">📅</div>
                <span>Agregar Evento</span>
            </button>
            <button class="action-btn" id="add-person-btn">
                <div class="action-emoji">👥</div>
                <span>Agregar Persona</span>
            </button>
            <button class="action-btn" id="add-emotion-btn">
                <div class="action-emoji">😊</div>
                <span>Registrar Emoción</span>
            </button>
        </div>

        <!-- Tareas Pendientes -->
        <div class="section-title">
            <h3>Tareas Pendientes 📋</h3>
            <a href="#" class="see-all" id="see-all-tasks">Ver todas</a>
        </div>
        <div class="cards-scroll" id="tasks-scroll">
            <!-- Las tareas se cargarán dinámicamente -->
        </div>

        <!-- Próximos Eventos -->
        <div class="section-title">
            <h3>Próximos Eventos 🗓️</h3>
            <a href="#" class="see-all" id="see-all-events">Ver todos</a>
        </div>
        <div class="cards-scroll" id="events-scroll">
            <!-- Los eventos se cargarán dinámicamente -->
        </div>

        <!-- Personas Especiales -->
        <div class="section-title">
            <h3>Personas Especiales 👨‍👩‍👧‍👦</h3>
            <a href="#" class="see-all" id="see-all-people">Ver todas</a>
        </div>
        <div class="cards-scroll" id="people-scroll">
            <!-- Las personas se cargarán dinámicamente -->
        </div>

        <!-- Bienestar Social -->
        <div class="section-title">
            <h3>Bienestar Social ❤️</h3>
        </div>

        <div class="emotion-form">
            <form id="emotion-form">
                <div class="form-group">
                    <label for="person-select">Persona:</label>
                    <select id="person-select" class="form-control" required>
                        <option value="">Selecciona una persona</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Emociones que sentiste:</label>
                    <div class="emotion-tags">
                        <span class="emotion-tag" data-emotion="Alegría">
                            <span class="emoji">😊</span> Alegría
                        </span>
                        <span class="emotion-tag" data-emotion="Tristeza">
                            <span class="emoji">😢</span> Tristeza
                        </span>
                        <span class="emotion-tag" data-emotion="Enojo">
                            <span class="emoji">😠</span> Enojo
                        </span>
                        <span class="emotion-tag" data-emotion="Miedo">
                            <span class="emoji">😨</span> Miedo
                        </span>
                        <span class="emotion-tag" data-emotion="Sorpresa">
                            <span class="emoji">😲</span> Sorpresa
                        </span>
                        <span class="emotion-tag" data-emotion="Confianza">
                            <span class="emoji">😌</span> Confianza
                        </span>
                        <span class="emotion-tag" data-emotion="Amor">
                            <span class="emoji">❤️</span> Amor
                        </span>
                        <span class="emotion-tag" data-emotion="Frustración">
                            <span class="emoji">😤</span> Frustración
                        </span>
                    </div>
                    <input type="hidden" id="selected-emotions">
                </div>
                <div class="form-group">
                    <label for="emotion-description">Descripción:</label>
                    <textarea id="emotion-description" class="form-control" rows="3" placeholder="Describe la situación y tus sentimientos..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Registrar Emoción ✨</button>
            </form>
        </div>

        <!-- Análisis de Relaciones -->
        <div class="emotion-form">
            <h3>Análisis de Relaciones 🔍</h3>
            <div class="form-group">
                <label for="analysis-person">Persona a analizar:</label>
                <select id="analysis-person" class="form-control">
                    <option value="">Todas las personas</option>
                </select>
            </div>
            <button id="analyze-btn" class="btn btn-primary">Analizar Relación 📊</button>

            <div id="analysis-result" class="analysis-result" style="display: none;">
                <h4>Resultados del análisis:</h4>
                <p id="analysis-text"></p>
                <div id="recommendation" class="recommendation" style="display: none;">
                    <h4>Recomendación 💡</h4>
                    <p id="recommendation-text"></p>
                </div>
            </div>
        </div>
    </main>

    <!-- Navegación Inferior -->
    <nav class="bottom-nav">
        <a href="#" class="nav-item active">
            <i class="fas fa-home nav-icon"></i>
            <span>Inicio</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-calendar nav-icon"></i>
            <span>Horario</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-chart-bar nav-icon"></i>
            <span>Progreso</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-heart nav-icon"></i>
            <span>Bienestar</span>
        </a>
    </nav>

    <!-- Modal para Agregar Tarea -->
    <div class="modal" id="task-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nueva Tarea 📝</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="task-form">
                <div class="form-group">
                    <label for="task-title">Título</label>
                    <input type="text" id="task-title" class="form-control" placeholder="Ej: Proyecto de Programación" required>
                </div>
                <div class="form-group">
                    <label for="task-description">Descripción</label>
                    <textarea id="task-description" class="form-control" rows="3" placeholder="Detalles de la tarea..."></textarea>
                </div>
                <div class="form-group">
                    <label for="task-priority">Prioridad</label>
                    <select id="task-priority" class="form-control">
                        <option value="low">🟢 Baja</option>
                        <option value="medium">🟡 Media</option>
                        <option value="high">🔴 Alta</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="task-deadline">Fecha límite</label>
                    <input type="date" id="task-deadline" class="form-control">
                </div>
                <button type="submit" class="btn btn-primary">Agregar Tarea ✅</button>
            </form>
        </div>
    </div>

    <!-- Modal para Agregar Persona -->
    <div class="modal" id="person-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Agregar Persona 👥</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="person-form">
                <div class="form-group">
                    <label for="person-name">Nombre</label>
                    <input type="text" id="person-name" class="form-control" placeholder="Nombre de la persona" required>
                </div>
                <div class="form-group">
                    <label for="person-relation">Relación</label>
                    <select id="person-relation" class="form-control" required>
                        <option value="">Selecciona una relación</option>
                        <option value="Amigo/a">👫 Amigo/a</option>
                        <option value="Pareja">💑 Pareja</option>
                        <option value="Familiar">👨‍👩‍👧‍👦 Familiar</option>
                        <option value="Compañero/a de clase">🎓 Compañero/a de clase</option>
                        <option value="Profesor/a">👨‍🏫 Profesor/a</option>
                        <option value="Mentor">🧠 Mentor</option>
                        <option value="Otro">❓ Otro</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Agregar Persona ✅</button>
            </form>
        </div>
    </div>

    <!-- Modal para Agregar Evento -->
    <div class="modal" id="event-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nuevo Evento 📅</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="event-form">
                <div class="form-group">
                    <label for="event-title">Título</label>
                    <input type="text" id="event-title" class="form-control" placeholder="Ej: Clase de Programación" required>
                </div>
                <div class="form-group">
                    <label for="event-date">Fecha</label>
                    <input type="date" id="event-date" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="event-time">Hora</label>
                    <input type="time" id="event-time" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="event-description">Descripción</label>
                    <textarea id="event-description" class="form-control" rows="3" placeholder="Detalles del evento..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Agregar Evento ✅</button>
            </form>
        </div>
    </div>

    <!-- Modal de Confirmación de Eliminación -->
    <div class="modal" id="delete-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="delete-title">Confirmar Eliminación 🗑️</h3>
                <button class="close-modal">&times;</button>
            </div>
            <p id="delete-message">¿Estás seguro de que quieres eliminar este elemento?</p>
            <div class="modal-actions">
                <button class="btn btn-cancel" id="cancel-delete">Cancelar</button>
                <button class="btn btn-danger" id="confirm-delete">Eliminar</button>
            </div>
        </div>
    </div>

    <script>
        // ========== DATOS Y ESTADO ==========
        let appData = {
            tasks: [
                { id: 1, title: "Proyecto de Bases de Datos", completed: false, priority: "high", deadline: "2023-10-20", description: "Entregar el proyecto final" },
                { id: 2, title: "Ensayo de Ética", completed: false, priority: "medium", deadline: "2023-10-18", description: "Ensayo sobre dilemas éticos" },
                { id: 3, title: "Ejercicios de Cálculo", completed: true, priority: "low", deadline: "2023-10-15", description: "Capítulo 5 ejercicios 1-10" }
            ],
            events: [
                { id: 1, title: "Clase de Programación", date: "2023-10-16", time: "15:30", description: "Aula 304" },
                { id: 2, title: "Reunión equipo proyecto", date: "2023-10-16", time: "17:00", description: "Biblioteca central" },
                { id: 3, title: "Entrega de tarea de Física", date: "2023-10-17", time: "23:59", description: "Subir al campus virtual" }
            ],
            people: [
                { id: 1, name: "Ana García", relation: "Amigo/a", emoji: "👫" },
                { id: 2, name: "Carlos Mendoza", relation: "Pareja", emoji: "💑" },
                { id: 3, name: "Prof. Rodríguez", relation: "Profesor/a", emoji: "👨‍🏫" }
            ],
            emotions: [
                { id: 1, person: "Ana García", date: "2023-10-15", emotions: ["Alegría", "Confianza"], description: "Pasamos un buen rato estudiando juntas" },
                { id: 2, person: "Carlos Mendoza", date: "2023-10-14", emotions: ["Amor", "Alegría"], description: "Cenamos juntos y hablamos de nuestro futuro" },
                { id: 3, person: "Prof. Rodríguez", date: "2023-10-12", emotions: ["Frustración", "Enojo"], description: "No entendí bien la explicación en clase" }
            ]
        };

        // Variables para el sistema de eliminación
        let itemToDelete = null;
        let deleteType = null;

        // ========== INICIALIZACIÓN ==========
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            renderAllData();
        });

        function initializeApp() {
            // Cargar datos guardados
            const savedData = localStorage.getItem('upmhAppData');
            if (savedData) {
                appData = JSON.parse(savedData);
            }

            // Actualizar fecha y hora
            updateDateTime();
            setInterval(updateDateTime, 60000);

            // Actualizar mensaje de bienvenida
            updateWelcomeMessage();
        }

        function setupEventListeners() {
            // Modales
            document.getElementById('add-task-btn').addEventListener('click', openTaskModal);
            document.getElementById('add-person-btn').addEventListener('click', openPersonModal);
            document.getElementById('add-event-btn').addEventListener('click', openEventModal);
            document.getElementById('add-emotion-btn').addEventListener('click', scrollToEmotions);

            // Formularios
            document.getElementById('task-form').addEventListener('submit', handleTaskSubmit);
            document.getElementById('person-form').addEventListener('submit', handlePersonSubmit);
            document.getElementById('event-form').addEventListener('submit', handleEventSubmit);
            document.getElementById('emotion-form').addEventListener('submit', handleEmotionSubmit);
            document.getElementById('analyze-btn').addEventListener('click', analyzeRelationships);

            // Eliminación
            document.getElementById('cancel-delete').addEventListener('click', closeDeleteModal);
            document.getElementById('confirm-delete').addEventListener('click', confirmDelete);

            // Cerrar modales
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', closeAllModals);
            });

            // Navegación
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // Ver todos
            document.getElementById('see-all-tasks').addEventListener('click', function(e) {
                e.preventDefault();
                showAllItems('tasks');
            });
            document.getElementById('see-all-events').addEventListener('click', function(e) {
                e.preventDefault();
                showAllItems('events');
            });
            document.getElementById('see-all-people').addEventListener('click', function(e) {
                e.preventDefault();
                showAllItems('people');
            });
        }

        // ========== RENDERIZADO ==========
        function renderAllData() {
            renderTasks();
            renderEvents();
            renderPeople();
            updateStats();
            populatePersonSelects();
        }

        function renderTasks() {
            const container = document.getElementById('tasks-scroll');
            const pendingTasks = appData.tasks.filter(task => !task.completed);

            if (pendingTasks.length === 0) {
                container.innerHTML = `
                    <div class="card">
                        <div class="empty-state">
                            <div class="empty-icon">🎉</div>
                            <p>¡No tienes tareas pendientes!</p>
                        </div>
                    </div>
                `;
                return;
            }

            container.innerHTML = pendingTasks.map(task => `
                <div class="card">
                    <div class="card-actions">
                        <button class="action-btn-small delete-btn" data-id="${task.id}" data-type="task">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="task-item">
                        <input type="checkbox" class="task-checkbox" data-id="${task.id}" ${task.completed ? 'checked' : ''}>
                        <div class="task-text">${task.title}</div>
                        <div class="task-priority priority-${task.priority}">
                            ${task.priority === 'high' ? '🔴' : task.priority === 'medium' ? '🟡' : '🟢'} ${task.priority}
                        </div>
                    </div>
                    ${task.deadline ? `<div style="font-size: 0.8rem; color: #777; margin-top: 5px;">📅 ${formatDate(task.deadline)}</div>` : ''}
                    ${task.description ? `<div style="font-size: 0.8rem; color: #777; margin-top: 5px;">${task.description}</div>` : ''}
                </div>
            `).join('');

            // Agregar event listeners a los checkboxes
            document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const taskId = parseInt(this.getAttribute('data-id'));
                    toggleTaskCompletion(taskId);
                });
            });

            // Agregar event listeners a los botones de eliminar
            document.querySelectorAll('.delete-btn[data-type="task"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const taskId = parseInt(this.getAttribute('data-id'));
                    const task = appData.tasks.find(t => t.id === taskId);
                    if (task) {
                        openDeleteModal('task', taskId, task.title);
                    }
                });
            });
        }

        function renderEvents() {
            const container = document.getElementById('events-scroll');
            const today = new Date().toISOString().split('T')[0];
            const upcomingEvents = appData.events.filter(event => event.date >= today)
                .sort((a, b) => new Date(a.date) - new Date(b.date))
                .slice(0, 3);

            if (upcomingEvents.length === 0) {
                container.innerHTML = `
                    <div class="card">
                        <div class="empty-state">
                            <div class="empty-icon">📅</div>
                            <p>No hay eventos próximos</p>
                        </div>
                    </div>
                `;
                return;
            }

            container.innerHTML = upcomingEvents.map(event => `
                <div class="card">
                    <div class="card-actions">
                        <button class="action-btn-small delete-btn" data-id="${event.id}" data-type="event">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="event-item">
                        <div class="event-time">${event.time}</div>
                        <div class="event-text">${event.title}</div>
                    </div>
                    <div style="font-size: 0.8rem; color: #777; margin-top: 5px;">
                        📅 ${formatDate(event.date)} ${event.description ? `• ${event.description}` : ''}
                    </div>
                </div>
            `).join('');

            // Agregar event listeners a los botones de eliminar
            document.querySelectorAll('.delete-btn[data-type="event"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const eventId = parseInt(this.getAttribute('data-id'));
                    const event = appData.events.find(e => e.id === eventId);
                    if (event) {
                        openDeleteModal('event', eventId, event.title);
                    }
                });
            });
        }

        function renderPeople() {
            const container = document.getElementById('people-scroll');

            if (appData.people.length === 0) {
                container.innerHTML = `
                    <div class="card">
                        <div class="empty-state">
                            <div class="empty-icon">👥</div>
                            <p>No hay personas agregadas</p>
                        </div>
                    </div>
                `;
                return;
            }

            container.innerHTML = appData.people.map(person => `
                <div class="card">
                    <div class="card-actions">
                        <button class="action-btn-small delete-btn" data-id="${person.id}" data-type="person">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="person-item">
                        <div class="person-avatar">${person.emoji}</div>
                        <div class="person-info">
                            <div class="person-name">${person.name}</div>
                            <div class="person-relation">${person.relation}</div>
                        </div>
                    </div>
                </div>
            `).join('');

            // Agregar event listeners a los botones de eliminar
            document.querySelectorAll('.delete-btn[data-type="person"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const personId = parseInt(this.getAttribute('data-id'));
                    const person = appData.people.find(p => p.id === personId);
                    if (person) {
                        openDeleteModal('person', personId, person.name);
                    }
                });
            });
        }

        // ========== FUNCIONALIDADES DE ELIMINACIÓN ==========
        function openDeleteModal(type, id, name) {
            itemToDelete = id;
            deleteType = type;

            const modal = document.getElementById('delete-modal');
            const title = document.getElementById('delete-title');
            const message = document.getElementById('delete-message');

            let typeText = '';
            switch(type) {
                case 'task':
                    typeText = 'tarea';
                    break;
                case 'event':
                    typeText = 'evento';
                    break;
                case 'person':
                    typeText = 'persona';
                    break;
            }

            title.textContent = `Eliminar ${typeText} 🗑️`;
            message.textContent = `¿Estás seguro de que quieres eliminar "${name}"? Esta acción no se puede deshacer.`;

            modal.style.display = 'flex';
        }

        function closeDeleteModal() {
            document.getElementById('delete-modal').style.display = 'none';
            itemToDelete = null;
            deleteType = null;
        }

        function confirmDelete() {
            if (!itemToDelete || !deleteType) return;

            switch(deleteType) {
                case 'task':
                    appData.tasks = appData.tasks.filter(task => task.id !== itemToDelete);
                    // También eliminar emociones relacionadas con esta persona si es una persona
                    const person = appData.people.find(p => p.id === itemToDelete);
                    if (person) {
                        appData.emotions = appData.emotions.filter(emotion => emotion.person !== person.name);
                    }
                    break;
                case 'event':
                    appData.events = appData.events.filter(event => event.id !== itemToDelete);
                    break;
                case 'person':
                    const personToDelete = appData.people.find(p => p.id === itemToDelete);
                    if (personToDelete) {
                        appData.people = appData.people.filter(person => person.id !== itemToDelete);
                        // Eliminar emociones relacionadas con esta persona
                        appData.emotions = appData.emotions.filter(emotion => emotion.person !== personToDelete.name);
                    }
                    break;
            }

            saveData();
            renderAllData();
            closeDeleteModal();
            showNotification('Elemento eliminado correctamente 🗑️');
        }

        function showAllItems(type) {
            let title, items, emptyMessage, emptyIcon;

            switch(type) {
                case 'tasks':
                    title = 'Todas las Tareas 📋';
                    items = appData.tasks;
                    emptyMessage = 'No hay tareas';
                    emptyIcon = '📝';
                    break;
                case 'events':
                    title = 'Todos los Eventos 📅';
                    items = appData.events;
                    emptyMessage = 'No hay eventos';
                    emptyIcon = '🗓️';
                    break;
                case 'people':
                    title = 'Todas las Personas 👥';
                    items = appData.people;
                    emptyMessage = 'No hay personas';
                    emptyIcon = '👤';
                    break;
            }

            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>${title}</h3>
                        <button class="close-modal">&times;</button>
                    </div>
                    <div style="max-height: 400px; overflow-y: auto;">
                        ${items.length === 0 ? `
                            <div class="empty-state">
                                <div class="empty-icon">${emptyIcon}</div>
                                <p>${emptyMessage}</p>
                            </div>
                        ` : items.map(item => {
                            if (type === 'tasks') {
                                return `
                                    <div class="task-item" style="padding: 1rem; border-bottom: 1px solid #eee;">
                                        <input type="checkbox" class="task-checkbox" data-id="${item.id}" ${item.completed ? 'checked' : ''}>
                                        <div class="task-text">${item.title}</div>
                                        <div class="task-priority priority-${item.priority}">
                                            ${item.priority === 'high' ? '🔴' : item.priority === 'medium' ? '🟡' : '🟢'} ${item.priority}
                                        </div>
                                        <button class="action-btn-small delete-btn" data-id="${item.id}" data-type="task" style="margin-left: 10px;">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                `;
                            } else if (type === 'events') {
                                return `
                                    <div class="event-item" style="padding: 1rem; border-bottom: 1px solid #eee;">
                                        <div class="event-time">${item.time}</div>
                                        <div class="event-text">${item.title}</div>
                                        <button class="action-btn-small delete-btn" data-id="${item.id}" data-type="event" style="margin-left: 10px;">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                    <div style="font-size: 0.8rem; color: #777; margin-bottom: 1rem;">
                                        📅 ${formatDate(item.date)} ${item.description ? `• ${item.description}` : ''}
                                    </div>
                                `;
                            } else if (type === 'people') {
                                return `
                                    <div class="person-item" style="padding: 1rem; border-bottom: 1px solid #eee;">
                                        <div class="person-avatar">${item.emoji}</div>
                                        <div class="person-info">
                                            <div class="person-name">${item.name}</div>
                                            <div class="person-relation">${item.relation}</div>
                                        </div>
                                        <button class="action-btn-small delete-btn" data-id="${item.id}" data-type="person" style="margin-left: 10px;">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                `;
                            }
                        }).join('')}
                    </div>
                </div>
            `;

            document.body.appendChild(modal);

            // Event listeners para el modal
            modal.querySelector('.close-modal').addEventListener('click', () => {
                document.body.removeChild(modal);
            });

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });

            // Event listeners para checkboxes de tareas
            modal.querySelectorAll('.task-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const taskId = parseInt(this.getAttribute('data-id'));
                    toggleTaskCompletion(taskId);
                    document.body.removeChild(modal);
                    showAllItems('tasks');
                });
            });

            // Event listeners para botones de eliminar
            modal.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const deleteType = this.getAttribute('data-type');
                    let item;

                    if (deleteType === 'task') {
                        item = appData.tasks.find(t => t.id === id);
                    } else if (deleteType === 'event') {
                        item = appData.events.find(e => e.id === id);
                    } else if (deleteType === 'person') {
                        item = appData.people.find(p => p.id === id);
                    }

                    if (item) {
                        document.body.removeChild(modal);
                        openDeleteModal(deleteType, id, deleteType === 'task' ? item.title : item.name);
                    }
                });
            });
        }

        // ========== FUNCIONALIDADES EXISTENTES ==========
        function openTaskModal() {
            document.getElementById('task-modal').style.display = 'flex';
            document.getElementById('task-deadline').valueAsDate = new Date();
        }

        function openPersonModal() {
            document.getElementById('person-modal').style.display = 'flex';
        }

        function openEventModal() {
            document.getElementById('event-modal').style.display = 'flex';
            document.getElementById('event-date').valueAsDate = new Date();
            document.getElementById('event-time').value = '09:00';
        }

        function scrollToEmotions() {
            document.querySelector('.emotion-form').scrollIntoView({ behavior: 'smooth' });
        }

        function closeAllModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
            itemToDelete = null;
            deleteType = null;
        }

        function handleTaskSubmit(e) {
            e.preventDefault();
            const formData = new FormData(e.target);

            const newTask = {
                id: Date.now(),
                title: document.getElementById('task-title').value,
                description: document.getElementById('task-description').value,
                priority: document.getElementById('task-priority').value,
                deadline: document.getElementById('task-deadline').value,
                completed: false
            };

            appData.tasks.push(newTask);
            saveData();
            renderAllData();
            closeAllModals();
            showNotification('¡Tarea agregada correctamente! ✅');
            e.target.reset();
        }

        function handlePersonSubmit(e) {
            e.preventDefault();

            const relationEmojis = {
                "Amigo/a": "👫",
                "Pareja": "💑",
                "Familiar": "👨‍👩‍👧‍👦",
                "Compañero/a de clase": "🎓",
                "Profesor/a": "👨‍🏫",
                "Mentor": "🧠",
                "Otro": "❓"
            };

            const newPerson = {
                id: Date.now(),
                name: document.getElementById('person-name').value,
                relation: document.getElementById('person-relation').value,
                emoji: relationEmojis[document.getElementById('person-relation').value] || "👤"
            };

            appData.people.push(newPerson);
            saveData();
            renderAllData();
            closeAllModals();
            showNotification('¡Persona agregada correctamente! 👥');
            e.target.reset();
        }

        function handleEventSubmit(e) {
            e.preventDefault();

            const newEvent = {
                id: Date.now(),
                title: document.getElementById('event-title').value,
                date: document.getElementById('event-date').value,
                time: document.getElementById('event-time').value,
                description: document.getElementById('event-description').value
            };

            appData.events.push(newEvent);
            saveData();
            renderAllData();
            closeAllModals();
            showNotification('¡Evento agregado correctamente! 📅');
            e.target.reset();
        }

        function handleEmotionSubmit(e) {
            e.preventDefault();

            const selectedEmotions = Array.from(document.querySelectorAll('.emotion-tag.active'))
                .map(tag => tag.getAttribute('data-emotion'));

            if (selectedEmotions.length === 0) {
                showNotification('Por favor selecciona al menos una emoción', 'error');
                return;
            }

            const newEmotion = {
                id: Date.now(),
                person: document.getElementById('person-select').value,
                date: new Date().toISOString().split('T')[0],
                emotions: selectedEmotions,
                description: document.getElementById('emotion-description').value
            };

            appData.emotions.push(newEmotion);
            saveData();
            showNotification('¡Emoción registrada correctamente! ❤️');
            e.target.reset();

            // Limpiar selección de emociones
            document.querySelectorAll('.emotion-tag.active').forEach(tag => {
                tag.classList.remove('active');
            });
        }

        function toggleTaskCompletion(taskId) {
            const task = appData.tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                saveData();
                renderAllData();
                showNotification(task.completed ? '¡Tarea completada! 🎉' : 'Tarea marcada como pendiente');
            }
        }

        function analyzeRelationships() {
            const selectedPerson = document.getElementById('analysis-person').value;
            let filteredEmotions = appData.emotions;

            if (selectedPerson) {
                filteredEmotions = appData.emotions.filter(entry => entry.person === selectedPerson);
            }

            if (filteredEmotions.length === 0) {
                document.getElementById('analysis-text').textContent = 'No hay suficientes datos para analizar. Registra más emociones primero.';
                document.getElementById('recommendation').style.display = 'none';
            } else {
                const emotionCount = {};
                filteredEmotions.forEach(entry => {
                    entry.emotions.forEach(emotion => {
                        emotionCount[emotion] = (emotionCount[emotion] || 0) + 1;
                    });
                });

                const sortedEmotions = Object.entries(emotionCount)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 3);

                let analysis = selectedPerson ? 
                    `En tu relación con ${selectedPerson}, las emociones más frecuentes son: ` :
                    `En general, tus emociones más frecuentes son: `;

                analysis += sortedEmotions.map(entry => `${entry[0]} (${entry[1]} veces)`).join(', ');

                // Calcular ratio positivo/negativo
                const positiveEmotions = ['Alegría', 'Confianza', 'Amor', 'Sorpresa'];
                const negativeEmotions = ['Tristeza', 'Enojo', 'Miedo', 'Frustración'];

                let positiveCount = 0;
                let negativeCount = 0;

                Object.entries(emotionCount).forEach(([emotion, count]) => {
                    if (positiveEmotions.includes(emotion)) {
                        positiveCount += count;
                    } else if (negativeEmotions.includes(emotion)) {
                        negativeCount += count;
                    }
                });

                const total = positiveCount + negativeCount;
                const positiveRatio = total > 0 ? (positiveCount / total) * 100 : 0;

                analysis += `. \n\nEl ${positiveRatio.toFixed(1)}% de tus emociones son positivas.`;

                document.getElementById('analysis-text').textContent = analysis;

                // Generar recomendación
                let recommendationMsg = '';
                if (positiveRatio >= 70) {
                    recommendationMsg = '¡Excelente! 🎉 Tu relación parece muy saludable. Sigue cultivando estos momentos positivos.';
                } else if (positiveRatio >= 40) {
                    recommendationMsg = 'Tu relación tiene aspectos positivos y áreas de mejora. 💭 Considera hablar abiertamente sobre lo que te molesta.';
                } else {
                    recommendationMsg = 'Parece que hay desafíos en esta relación. 🤔 Podría ser útil buscar apoyo o tener una conversación honesta sobre tus sentimientos.';
                }

                document.getElementById('recommendation-text').textContent = recommendationMsg;
                document.getElementById('recommendation').style.display = 'block';
            }

            document.getElementById('analysis-result').style.display = 'block';
        }

        // ========== UTILIDADES ==========
        function updateDateTime() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = now.toLocaleDateString('es-ES', options);
        }

        function updateWelcomeMessage() {
            const hour = new Date().getHours();
            let message = '';

            if (hour < 12) message = '¡Buenos días! ☀️';
            else if (hour < 18) message = '¡Buenas tardes! 🌤️';
            else message = '¡Buenas noches! 🌙';

            document.getElementById('welcome-message').textContent = message;
        }

        function updateStats() {
            const completedTasks = appData.tasks.filter(task => task.completed).length;
            const totalTasks = appData.tasks.length;
            const progressPercentage = totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;

            document.getElementById('task-count').textContent = `${completedTasks}/${totalTasks}`;
            document.getElementById('emotion-count').textContent = appData.emotions.length;
            document.getElementById('progress-fill').style.width = `${progressPercentage}%`;
        }

        function populatePersonSelects() {
            const personSelect = document.getElementById('person-select');
            const analysisSelect = document.getElementById('analysis-person');

            // Limpiar opciones excepto la primera
            while (personSelect.children.length > 1) personSelect.removeChild(personSelect.lastChild);
            while (analysisSelect.children.length > 1) analysisSelect.removeChild(analysisSelect.lastChild);

            // Agregar personas
            appData.people.forEach(person => {
                const option1 = document.createElement('option');
                option1.value = person.name;
                option1.textContent = person.name;
                personSelect.appendChild(option1);

                const option2 = document.createElement('option');
                option2.value = person.name;
                option2.textContent = person.name;
                analysisSelect.appendChild(option2);
            });
        }

        function formatDate(dateString) {
            const options = { day: 'numeric', month: 'short' };
            return new Date(dateString).toLocaleDateString('es-ES', options);
        }

        function saveData() {
            localStorage.setItem('upmhAppData', JSON.stringify(appData));
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.background = type === 'error' ? 'var(--danger-color)' : 'var(--success-color)';
            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // ========== EVENT LISTENERS ADICIONALES ==========
        // Emoción tags
        document.querySelectorAll('.emotion-tag').forEach(tag => {
            tag.addEventListener('click', function() {
                this.classList.toggle('active');
            });
        });

        // Cerrar modal al hacer clic fuera
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    closeAllModals();
                }
            });
        });
    </script>
</body>
</html>